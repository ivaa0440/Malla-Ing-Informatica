<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Malla Curricular - Ingeniería en Informática (UNLaM)</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #111;
      color: #fff;
    }
    h2 {
      margin: 1rem;
    }
    .container {
      display: flex;
      overflow-x: auto;
      padding: 1rem;
      gap: 1rem;
    }
    .column {
      flex: 0 0 auto;
      background: #1e1e1e;
      padding: 1rem;
      border-radius: 10px;
      width: 280px;
    }
    .column h3 {
      text-align: center;
      margin-bottom: 0.5rem;
      color: #ccc;
    }
    .materia {
      background-color: #2a2a2a;
      border: 1px solid #444;
      border-radius: 8px;
      padding: 0.5rem;
      margin: 0.4rem 0;
      cursor: pointer;
      position: relative;
      transition: 0.3s;
    }
    .materia span.codigo {
      display: block;
      font-size: 0.8em;
      color: #999;
    }
    .materia.aprobada {
      background-color: #224422;
    }
    .materia.aprobada::after {
      content: "";
      position: absolute;
      top: 5px;
      left: 5px;
      width: calc(100% - 10px);
      height: calc(100% - 10px);
      border-top: 2px solid red;
      transform: rotate(-45deg);
      pointer-events: none;
    }
    .materia.bloqueada {
      background-color: #444;
      color: #888;
      cursor: not-allowed;
    }
    .materia.bloqueada::after {
      content: attr(data-tooltip);
      position: absolute;
      top: 100%;
      left: 0;
      background: #222;
      color: #eee;
      font-size: 0.75em;
      padding: 0.3rem;
      border: 1px solid #555;
      border-radius: 5px;
      white-space: normal;
      display: none;
      z-index: 10;
      width: 200px;
    }
    .materia.bloqueada:hover::after {
      display: block;
    }
  </style>
</head>
<body>
  <h2>Malla Curricular - Ingeniería en Informática (UNLaM)</h2>
  <div class="container" id="malla"></div>

  <script>
    const materias = [
      {
        ciclo: "1er Año - 1° Cuatrimestre",
        materias: [
          { codigo: "3621", nombre: "Matemática Discreta" },
          { codigo: "3622", nombre: "Análisis Matemático I" },
          { codigo: "3623", nombre: "Programación Inicial" },
          { codigo: "3624", nombre: "Introducción a los Sistemas de Información" },
          { codigo: "3625", nombre: "Sistemas de Numeración" },
          { codigo: "3626", nombre: "Principios de Calidad de Software" },
        ]
      },
      {
        ciclo: "1er Año - 2° Cuatrimestre",
        materias: [
          { codigo: "3627", nombre: "Álgebra y Geometría Analítica I", correlativas: ["3622"] },
          { codigo: "3628", nombre: "Física I", correlativas: ["3622"] },
          { codigo: "3629", nombre: "Programación Estructurada Básica", correlativas: ["3623", "3625"] },
          { codigo: "3630", nombre: "Introducción a la Gestión de Proyectos", correlativas: ["3624"] },
          { codigo: "3631", nombre: "Fundamentos de Sistemas Embebidos", correlativas: ["3625"] },
          { codigo: "3632", nombre: "Introducción a los Proyectos Informáticos", correlativas: ["3626"] },
        ]
      },
      // Agregá los demás ciclos aquí siguiendo la misma estructura
    ];

    const aprobadas = JSON.parse(localStorage.getItem("materiasAprobadas") || "[]");

    function guardarAprobadas() {
      localStorage.setItem("materiasAprobadas", JSON.stringify(aprobadas));
    }

    function renderMalla() {
      const cont = document.getElementById("malla");
      cont.innerHTML = "";

      materias.forEach(bloque => {
        const col = document.createElement("div");
        col.className = "column";
        const titulo = document.createElement("h3");
        titulo.textContent = bloque.ciclo;
        col.appendChild(titulo);

        bloque.materias.forEach(mat => {
          const div = document.createElement("div");
          div.className = "materia";
          div.dataset.codigo = mat.codigo;
          div.innerHTML = `<strong>${mat.nombre}</strong><span class="codigo">${mat.codigo}</span>`;

          const estaAprobada = aprobadas.includes(mat.codigo);
          const faltan = (mat.correlativas || []).filter(c => !aprobadas.includes(c));

          if (estaAprobada) {
            div.classList.add("aprobada");
          } else if (faltan.length) {
            div.classList.add("bloqueada");
            div.dataset.tooltip = `Faltan: ${faltan.join(", ")}`;
          }

          div.addEventListener("click", () => {
            if (div.classList.contains("bloqueada")) return;
            const idx = aprobadas.indexOf(mat.codigo);
            if (idx >= 0) {
              aprobadas.splice(idx, 1);
            } else {
              aprobadas.push(mat.codigo);
            }
            guardarAprobadas();
            renderMalla();
          });

          col.appendChild(div);
        });

        cont.appendChild(col);
      });
    }

    renderMalla();
  </script>
</body>
</html>
